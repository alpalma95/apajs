let{isArray:t}=Array,{fromEntries:e,entries:s,keys:r}=Object,n=e=>{if("object"!=typeof e)return document.createTextNode(e);const s=document.createElement(e.type);return e.props&&((t,e)=>{r(e).forEach((s=>{s.startsWith("@")?((t,e,s)=>{t.addEventListener(e.slice(1),s)})(t,s,e[s]):t.setAttribute(s,e[s])}))})(s,e.props),e.children&&e.children.map((e=>t(e)?e.map(n):n(e))).forEach((e=>{t(e)?e.forEach((t=>s.appendChild(t))):s.appendChild(e)})),s},c=(e,s)=>{window.customElements.define(e.tag,class extends HTMLElement{constructor(){super(),this.ctx={onInit:(t=(()=>{}))=>t(),onDestroy:(t=(()=>{}))=>t(),subscribers:[],getHost:()=>this,watch:(t,e)=>this.ctx.subscribers.push({attributeName:t,cb:e})},e.shadow&&this.attachShadow({mode:e.shadow})}static get observedAttributes(){return e.observed}connectedCallback(){let e={};this.getAttributeNames().forEach((t=>{t.startsWith(":")&&(e[t.slice(1)]=this.getAttribute(t))})),this.ctx.props=e;let r=s(this.ctx),c=this.shadowRoot??this;t(r)?r.forEach((t=>c.appendChild(n(t)))):c.appendChild(n(r)),this.ctx.onInit()}attributeChangedCallback(t,e,s){this.ctx.subscribers.forEach((({attributeName:r,cb:n})=>{t===r&&n(t,e,s)}))}disconnectedCallback(){this.ctx.onDestroy()}})};const i=function(t){for(var e,s,r=arguments,n=1,c="",i="",o=[0],a=function(t){1===n&&(t||(c=c.replace(/^\s*\n\s*|\s*\n\s*$/g,"")))?o.push(t?r[t]:c):3===n&&(t||c)?(o[1]=t?r[t]:c,n=2):2===n&&"..."===c&&t?o[2]=Object.assign(o[2]||{},r[t]):2===n&&c&&!t?(o[2]=o[2]||{})[c]=!0:n>=5&&(5===n?((o[2]=o[2]||{})[s]=t?c?c+r[t]:r[t]:c,n=6):(t||c)&&(o[2][s]+=t?c+r[t]:c)),c=""},h=0;h<t.length;h++){h&&(1===n&&a(),a(h));for(var l=0;l<t[h].length;l++)e=t[h][l],1===n?"<"===e?(a(),o=[o,"",null],n=3):c+=e:4===n?"--"===c&&">"===e?(n=1,c=""):c=e+c[0]:i?e===i?i="":c+=e:'"'===e||"'"===e?i=e:">"===e?(a(),n=1):n&&("="===e?(n=5,s=c,c=""):"/"===e&&(n<5||">"===t[h][l+1])?(a(),3===n&&(o=o[0]),n=o,(o=o[0]).push(this.apply(null,n.slice(1))),n=0):" "===e||"\t"===e||"\n"===e||"\r"===e?(a(),n=2):c+=e),3===n&&"!--"===c&&(n=4,o=o[0])}return a(),o.length>2?o.slice(1):o[1]}.bind((function(t,e,...s){return{type:t,props:e,children:s}}));let o=null,a=t=>(o=t,t()),h=t=>{let e=new Set,s="object"==typeof t?Object.fromEntries(Object.entries(t).map((([t,e])=>[t,"object"==typeof e?h(e):e]))):"function"==typeof t?{val:a((()=>t))}:{val:t};return new Proxy(s,{get:(t,s)=>(null!==o&&(e.add(o),o=null),"function"==typeof t[s]?t[s]():t[s]),set:(t,s,r)=>(t[s]=r,e.forEach((t=>t())),!0)})};export{c as defineComponent,a as derive,i as html,h as stream};
//# sourceMappingURL=apa.min.js.map