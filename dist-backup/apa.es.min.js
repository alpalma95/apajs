let{isArray:e}=Array,t=(t,n)=>{window.customElements.define(t.tag,class extends HTMLElement{constructor(){super(),this.ctx={onInit:(e=(()=>{}))=>e(),onDestroy:(e=(()=>{}))=>e(),subscribers:[],getHost:()=>this,watch:(e,t)=>this.ctx.subscribers.push({attributeName:e,cb:t})},t.shadow&&this.attachShadow({mode:t.shadow})}static get observedAttributes(){return[t.observed]}connectedCallback(){let t={};this.getAttributeNames().forEach((e=>{e.startsWith(":")&&(t[e.slice(1)]=this.getAttribute(e))})),this.ctx.props=t;let r=(t=>e(t)?t.map((e=>"string"==typeof e?document.createTextNode(e):e)):"string"==typeof t?document.createTextNode(t):t)(n(this.ctx)),l=this.shadowRoot??this;e(r)?r.forEach((e=>l.appendChild(e))):l.appendChild(r),this.ctx.onInit()}attributeChangedCallback(e,t,n){this.ctx.subscribers.forEach((({attributeName:r,cb:l})=>{e===r&&l(e,t,n)}))}disconnectedCallback(){this.ctx.onDestroy()}})};let n,r,l,s,o,i=Object,a=i.getPrototypeOf,d=document,c={isConnected:1},f={},u=a(c),h=a(a),_=(e,t,n,r)=>(e??(setTimeout(n,r),new Set)).add(t),b=(e,t,n)=>{let r=l;l=t;try{return e(n)}catch(e){return n}finally{l=r}},g=e=>e.filter((e=>{var t;return null==(t=e._dom)?void 0:t.isConnected})),v=e=>o=_(o,e,(()=>{for(let e of o)e._bindings=g(e._bindings),e._listeners=g(e._listeners);o=n}),1e3),m={get val(){return null==l||l.add(this),this._val},get oldVal(){return null==l||l.add(this),this._oldVal},set val(e){let t=this;if(e!==t._val){t._val=e;let l=[...t._listeners=g(t._listeners)];for(let e of l)x(e.f,e.s,e._dom),e._dom=n;t._bindings.length?r=_(r,t,N):t._oldVal=e}}},p=e=>({__proto__:m,_val:e,_oldVal:e,_bindings:[],_listeners:[]}),y=e=>a(e??0)===m,w=(e,t)=>{let n=new Set,r={f:e},l=s;s=[];let o=b(e,n,t);o=(o??d).nodeType?o:new Text(o);for(let e of n)v(e),e._bindings.push(r);for(let e of s)e._dom=o;return s=l,r._dom=o},x=(e,t=p(),n)=>{let r=new Set,l={f:e,s:t};l._dom=n??(null==s?void 0:s.push(l))??c,t.val=b(e,r);for(let e of r)v(e),e._listeners.push(l);return t},C=(e,...t)=>{for(let r of t.flat(1/0)){let t=a(r??0),l=t===m?w((()=>r.val)):t===h?w(r):r;l!=n&&e.append(l)}return e},E=e=>new Proxy(((t,...r)=>{var l;let[s,...o]=a(r[0]??0)===u?r:[{},...r],c=e?d.createElementNS(e,t):d.createElement(t);for(let[e,r]of i.entries(s)){let s=t=>t?i.getOwnPropertyDescriptor(t,e)??s(a(t)):n,o=t+","+e,d=f[o]??(f[o]=(null==(l=s(a(c)))?void 0:l.set)??0),u=d?d.bind(c):c.setAttribute.bind(c,e),_=a(r??0);_===m?w((()=>(u(r.val),c))):_!==h||e.startsWith("on")&&!r._isBindingFunc?u(r):w((()=>(u(r()),c)))}return C(c,...o)}),{get:(e,t)=>e.bind(n,t)}),S=(e,t)=>t?t!==e&&e.replaceWith(t):e.remove(),N=()=>{let e=[...r].filter((e=>e._val!==e._oldVal));r=n;for(let t of new Set(e.flatMap((e=>e._bindings=g(e._bindings)))))S(t._dom,w(t.f,t._dom)),t._dom=n;for(let t of e)t._oldVal=t._val};const A={add:C,_:e=>(e._isBindingFunc=1,e),tags:E(),tagsNS:E,state:p,val:e=>y(e)?e.val:e,oldVal:e=>y(e)?e.oldVal:e,derive:x,hydrate:(e,t)=>S(e,w(t,e))};let D,V,{fromEntries:O,entries:P,keys:T,getPrototypeOf:j}=Object,{get:k,set:B,deleteProperty:W,ownKeys:F}=Reflect,H=Symbol,{state:I,derive:K,add:M,tags:R}=A,L=j(I()),$=H(),q=H(),z=H(),G=H(),J=H(),Q=H(),U=e=>null!=e&&e[z]?K((()=>X(e()))):I(X(e)),X=e=>{if(!(e instanceof Object)||e[$])return e;let t=new Proxy((e[$]=O(P(e).map((([e,t])=>[e,U(t)]))),e[q]=e,e[G]=[],e[J]=I(1),e),{get:(e,n)=>j(e[$][n]??0)===L?e[$][n].val:("length"===n&&e[J].val,k(e,n,t)),set(e,n,r){let l=e[$];if(n in l)return l[n].val=X(r),1;let s=n in e;return B(e,n,r)?(s||B(l,n,U(r))&&(++e[J].val,ee(t,n,l[n])),1):void 0},deleteProperty:(e,t)=>(W(e[$],t)&&te(e,t),W(e,t)&&++e[J].val),ownKeys:e=>(e[J].val,F(e))});return t},Y=e=>e[G]=e[G].filter((e=>e._containerDom.isConnected)),Z=(e,t,n,{_containerDom:r,f:l},s)=>{if(M(r,((e,t,n,r)=>()=>{let l=r(n,(()=>delete e[t]));return l[Q]=t,l})(e,t,n,l)),!s&&Array.isArray(e)&&t!=e.length-1){let t={};for(let e of r.childNodes)t[e[Q]]=e;let n=r.firstChild;for(let l of T(e))n===t[l]?n=n.nextSibling:r.insertBefore(t[l],n)}},ee=(e,t,n)=>Y(e).forEach(Z.bind(V,e,t,n)),te=(e,t)=>{var n;for(let r of Y(e))null==(n=[...r._containerDom.childNodes].find((e=>e[Q]===t)))||n.remove()},ne=(e,t,n)=>{let r={_containerDom:e(),f:n};t[G].push(r),(e=>{(D??(setTimeout((()=>(D.forEach(Y),D=V)),1e3),D=new Set)).add(e)})(t);for(let[e,n]of P(t[$]))Z(t,e,n,r,1);return r._containerDom},{state:re,derive:le,tags:se}=A;const oe=function(e){for(var t,n,r=arguments,l=1,s="",o="",i=[0],a=function(e){1===l&&(e||(s=s.replace(/^\s*\n\s*|\s*\n\s*$/g,"")))?i.push(e?r[e]:s):3===l&&(e||s)?(i[1]=e?r[e]:s,l=2):2===l&&"..."===s&&e?i[2]=Object.assign(i[2]||{},r[e]):2===l&&s&&!e?(i[2]=i[2]||{})[s]=!0:l>=5&&(5===l?((i[2]=i[2]||{})[n]=e?s?s+r[e]:r[e]:s,l=6):(e||s)&&(i[2][n]+=e?s+r[e]:s)),s=""},d=0;d<e.length;d++){d&&(1===l&&a(),a(d));for(var c=0;c<e[d].length;c++)t=e[d][c],1===l?"<"===t?(a(),i=[i,"",null],l=3):s+=t:4===l?"--"===s&&">"===t?(l=1,s=""):s=t+s[0]:o?t===o?o="":s+=t:'"'===t||"'"===t?o=t:">"===t?(a(),l=1):l&&("="===t?(l=5,n=s,s=""):"/"===t&&(l<5||">"===e[d][c+1])?(a(),3===l&&(i=i[0]),l=i,(i=i[0]).push(this.apply(null,l.slice(1))),l=0):" "===t||"\t"===t||"\n"===t||"\r"===t?(a(),l=2):s+=t),3===l&&"!--"===s&&(l=4,i=i[0])}return a(),i.length>2?i.slice(1):i[1]}.bind((function(e,t,...n){const r=se[e];return t?r(t,...n):r(...n)}));export{t as defineComponent,le as derive,oe as html,ne as list,X as reactive,re as state};
//# sourceMappingURL=apa.min.js.map