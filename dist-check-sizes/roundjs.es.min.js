class t extends HTMLElement{constructor(){super()}connectedCallback(){this.getProps(),this.firstRender(),this.onInit()}attributeChangedCallback(t,e,s){t.startsWith(":")?this[t.slice(1)]=s:this[t]=s,this.watch(t.slice(1),JSON.parse(e),JSON.parse(s))}disconnectedCallback(){this.onDestroy()}firstRender(){let t=this.shadowRoot?this.shadowRoot:this,e=(s=this.ctx.render(this.ctx),Array.isArray(s)?s.map((t=>"string"==typeof t?document.createTextNode(t):t)):"string"==typeof s?document.createTextNode(s):s);var s;Array.isArray(e)?e.forEach((e=>t.appendChild(e))):t.appendChild(e)}getProps(){this.getAttributeNames().forEach((t=>{if(!t.startsWith(":"))return;let e={};e[t.slice(1)]=JSON.parse(this.getAttribute(t)),this.ctx?this.ctx.props=e:this.props=e}))}watch(t,e,s){}onInit(){}onDestroy(){}render(){}}let e=(e,s,n={})=>{window.customElements.define(e,class extends t{constructor(){super(),this.ctx=(t=>{for(let e of Object.keys(t))"function"==typeof t[e]&&(t[e]=t[e].bind(t));return t})(s),this.ctx.getHost=()=>this,n.shadow&&this.attachShadow({mode:n.shadow})}onInit(){this.ctx&&"function"==typeof this.ctx.onInit&&this.ctx.onInit(this)}onDestroy(){this.ctx&&"function"==typeof this.ctx.onDestroy&&this.ctx.onDestroy(this)}watch(t,e,s){this.ctx&&"function"==typeof this.ctx.watch&&this.ctx.watch(t,e,s,this)}})};let s,n,i,o,r,l=Object,a=l.getPrototypeOf,d=document,c={isConnected:1},h={},f=a(c),u=a(a),p=(t,e,s,n)=>(t??(setTimeout(s,n),new Set)).add(e),_=(t,e,s)=>{let n=i;i=e;try{return t(s)}catch(t){return s}finally{i=n}},g=t=>t.filter((t=>{var e;return null==(e=t._dom)?void 0:e.isConnected})),v=t=>r=p(r,t,(()=>{for(let t of r)t._bindings=g(t._bindings),t._listeners=g(t._listeners);r=s}),1e3),y={get val(){return null==i||i.add(this),this._val},get oldVal(){return null==i||i.add(this),this._oldVal},set val(t){let e=this;if(t!==e._val){e._val=t;let i=[...e._listeners=g(e._listeners)];for(let t of i)w(t.f,t.s,t._dom),t._dom=s;e._bindings.length?n=p(n,e,N):e._oldVal=t}}},m=t=>({__proto__:y,_val:t,_oldVal:t,_bindings:[],_listeners:[]}),b=t=>a(t??0)===y,x=(t,e)=>{let s=new Set,n={f:t},i=o;o=[];let r=_(t,s,e);r=(r??d).nodeType?r:new Text(r);for(let t of s)v(t),t._bindings.push(n);for(let t of o)t._dom=r;return o=i,n._dom=r},w=(t,e=m(),s)=>{let n=new Set,i={f:t,s:e};i._dom=s??(null==o?void 0:o.push(i))??c,e.val=_(t,n);for(let t of n)v(t),t._listeners.push(i);return e},C=(t,...e)=>{for(let n of e.flat(1/0)){let e=a(n??0),i=e===y?x((()=>n.val)):e===u?x(n):n;i!=s&&t.append(i)}return t},S=t=>new Proxy(((e,...n)=>{var i;let[o,...r]=a(n[0]??0)===f?n:[{},...n],c=t?d.createElementNS(t,e):d.createElement(e);for(let[t,n]of l.entries(o)){let o=e=>e?l.getOwnPropertyDescriptor(e,t)??o(a(e)):s,r=e+","+t,d=h[r]??(h[r]=(null==(i=o(a(c)))?void 0:i.set)??0),f=d?d.bind(c):c.setAttribute.bind(c,t),p=a(n??0);p===y?x((()=>(f(n.val),c))):p!==u||t.startsWith("on")&&!n._isBindingFunc?f(n):x((()=>(f(n()),c)))}return C(c,...r)}),{get:(t,e)=>t.bind(s,e)}),O=(t,e)=>e?e!==t&&t.replaceWith(e):t.remove(),N=()=>{let t=[...n].filter((t=>t._val!==t._oldVal));n=s;for(let e of new Set(t.flatMap((t=>t._bindings=g(t._bindings)))))O(e._dom,x(e.f,e._dom)),e._dom=s;for(let e of t)e._oldVal=e._val};const V={add:C,_:t=>(t._isBindingFunc=1,t),tags:S(),tagsNS:S,state:m,val:t=>b(t)?t.val:t,oldVal:t=>b(t)?t.oldVal:t,derive:w,hydrate:(t,e)=>O(t,x(e,t))};const A=function(t){for(var e,s,n=arguments,i=1,o="",r="",l=[0],a=function(t){1===i&&(t||(o=o.replace(/^\s*\n\s*|\s*\n\s*$/g,"")))?l.push(t?n[t]:o):3===i&&(t||o)?(l[1]=t?n[t]:o,i=2):2===i&&"..."===o&&t?l[2]=Object.assign(l[2]||{},n[t]):2===i&&o&&!t?(l[2]=l[2]||{})[o]=!0:i>=5&&(5===i?((l[2]=l[2]||{})[s]=t?o?o+n[t]:n[t]:o,i=6):(t||o)&&(l[2][s]+=t?o+n[t]:o)),o=""},d=0;d<t.length;d++){d&&(1===i&&a(),a(d));for(var c=0;c<t[d].length;c++)e=t[d][c],1===i?"<"===e?(a(),l=[l,"",null],i=3):o+=e:4===i?"--"===o&&">"===e?(i=1,o=""):o=e+o[0]:r?e===r?r="":o+=e:'"'===e||"'"===e?r=e:">"===e?(a(),i=1):i&&("="===e?(i=5,s=o,o=""):"/"===e&&(i<5||">"===t[d][c+1])?(a(),3===i&&(l=l[0]),i=l,(l=l[0]).push(this.apply(null,i.slice(1))),i=0):" "===e||"\t"===e||"\n"===e||"\r"===e?(a(),i=2):o+=e),3===i&&"!--"===o&&(i=4,l=l[0])}return a(),l.length>2?l.slice(1):l[1]}.bind((function(t,e,...s){let n=(t=>{for(const e of Object.keys(t))e.startsWith("@")&&(t[`on${e.slice(1)}`]=t[e],delete t[e]);return t})({...e});const i=V.tags[t];return n?i(n,...s):i(...s)})),{state:D,derive:E}=V;export{t as ReactiveWC,e as defineComponent,E as derive,A as html,D as state};
//# sourceMappingURL=roundjs.min.js.map