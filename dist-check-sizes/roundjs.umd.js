(function(a,m){typeof exports=="object"&&typeof module<"u"?m(exports):typeof define=="function"&&define.amd?define(["exports"],m):(a=typeof globalThis<"u"?globalThis:a||self,m(a.roundjs={}))})(this,function(a){"use strict";let m=t=>Array.isArray(t)?t.map(s=>typeof s=="string"?document.createTextNode(s):s):typeof t=="string"?document.createTextNode(t):t;class T extends HTMLElement{constructor(){super()}connectedCallback(){this.getProps(),this.firstRender(),this.onInit()}attributeChangedCallback(e,s,o){e.startsWith(":")?this[e.slice(1)]=o:this[e]=o,this.watch(e.slice(1),JSON.parse(s),JSON.parse(o))}disconnectedCallback(){this.onDestroy()}firstRender(){let e=this.shadowRoot?this.shadowRoot:this,s=m(this.ctx.render(this.ctx));Array.isArray(s)?s.forEach(o=>e.appendChild(o)):e.appendChild(s)}getProps(){this.getAttributeNames().forEach(e=>{if(!e.startsWith(":"))return;let s={};s[e.slice(1)]=JSON.parse(this.getAttribute(e)),this.ctx?this.ctx.props=s:this.props=s})}watch(e,s,o){}onInit(){}onDestroy(){}render(){}}let z=t=>{for(let e of Object.keys(t))typeof t[e]=="function"&&(t[e]=t[e].bind(t));return t},B=(t,e,s={})=>{window.customElements.define(t,class extends T{constructor(){super(),this.ctx=z(e),this.ctx.getHost=()=>this,s.shadow&&this.attachShadow({mode:s.shadow})}onInit(){this.ctx&&typeof this.ctx.onInit=="function"&&this.ctx.onInit(this)}onDestroy(){this.ctx&&typeof this.ctx.onDestroy=="function"&&this.ctx.onDestroy(this)}watch(o,n,i){this.ctx&&typeof this.ctx.watch=="function"&&this.ctx.watch(o,n,i,this)}})};function G(t){for(var e,s,o=arguments,n=1,i="",c="",l=[0],d=function(r){n===1&&(r||(i=i.replace(/^\s*\n\s*|\s*\n\s*$/g,"")))?l.push(r?o[r]:i):n===3&&(r||i)?(l[1]=r?o[r]:i,n=2):n===2&&i==="..."&&r?l[2]=Object.assign(l[2]||{},o[r]):n===2&&i&&!r?(l[2]=l[2]||{})[i]=!0:n>=5&&(n===5?((l[2]=l[2]||{})[s]=r?i?i+o[r]:o[r]:i,n=6):(r||i)&&(l[2][s]+=r?i+o[r]:i)),i=""},f=0;f<t.length;f++){f&&(n===1&&d(),d(f));for(var g=0;g<t[f].length;g++)e=t[f][g],n===1?e==="<"?(d(),l=[l,"",null],n=3):i+=e:n===4?i==="--"&&e===">"?(n=1,i=""):i=e+i[0]:c?e===c?c="":i+=e:e==='"'||e==="'"?c=e:e===">"?(d(),n=1):n&&(e==="="?(n=5,s=i,i=""):e==="/"&&(n<5||t[f][g+1]===">")?(d(),n===3&&(l=l[0]),n=l,(l=l[0]).push(this.apply(null,n.slice(1))),n=0):e===" "||e==="	"||e===`
`||e==="\r"?(d(),n=2):i+=e),n===3&&i==="!--"&&(n=4,l=l[0])}return d(),l.length>2?l.slice(1):l[1]}let C=Object,u,h=C.getPrototypeOf,x=document,b,p,_,A={isConnected:1},H=1e3,v,k={},K=h(A),N=h(h),V=(t,e,s,o)=>(t??(setTimeout(s,o),new Set)).add(e),D=(t,e,s)=>{let o=p;p=e;try{return t(s)}catch(n){return console.error(n),s}finally{p=o}},S=t=>t.filter(e=>{var s;return(s=e._dom)==null?void 0:s.isConnected}),I=t=>v=V(v,t,()=>{for(let e of v)e._bindings=S(e._bindings),e._listeners=S(e._listeners);v=u},H),w={get val(){return p==null||p.add(this),this._val},get oldVal(){return p==null||p.add(this),this._oldVal},set val(t){let e=this;if(t!==e._val){e._val=t;let s=[...e._listeners=S(e._listeners)];for(let o of s)R(o.f,o.s,o._dom),o._dom=u;e._bindings.length?b=V(b,e,U):e._oldVal=t}}},W=t=>({__proto__:w,_val:t,_oldVal:t,_bindings:[],_listeners:[]}),E=t=>h(t??0)===w,L=t=>E(t)?t.val:t,q=t=>E(t)?t.oldVal:t,y=(t,e)=>{let s=new Set,o={f:t},n=_;_=[];let i=D(t,s,e);i=(i??x).nodeType?i:new Text(i);for(let c of s)I(c),c._bindings.push(o);for(let c of _)c._dom=i;return _=n,o._dom=i},R=(t,e=W(),s)=>{let o=new Set,n={f:t,s:e};n._dom=s??(_==null?void 0:_.push(n))??A,e.val=D(t,o);for(let i of o)I(i),i._listeners.push(n);return e},j=(t,...e)=>{for(let s of e.flat(1/0)){let o=h(s??0),n=o===w?y(()=>s.val):o===N?y(s):s;n!=u&&t.append(n)}return t},Q=t=>(t._isBindingFunc=1,t),M=t=>new Proxy((e,...s)=>{var c;let[o,...n]=h(s[0]??0)===K?s:[{},...s],i=t?x.createElementNS(t,e):x.createElement(e);for(let[l,d]of C.entries(o)){let f=P=>P?C.getOwnPropertyDescriptor(P,l)??f(h(P)):u,g=e+","+l,r=k[g]??(k[g]=((c=f(h(i)))==null?void 0:c.set)??0),O=r?r.bind(i):i.setAttribute.bind(i,l),J=h(d??0);J===w?y(()=>(O(d.val),i)):J===N&&(!l.startsWith("on")||d._isBindingFunc)?y(()=>(O(d()),i)):O(d)}return j(i,...n)},{get:(e,s)=>e.bind(u,s)}),$=(t,e)=>e?e!==t&&t.replaceWith(e):t.remove(),U=()=>{let t=[...b].filter(e=>e._val!==e._oldVal);b=u;for(let e of new Set(t.flatMap(s=>s._bindings=S(s._bindings))))$(e._dom,y(e.f,e._dom)),e._dom=u;for(let e of t)e._oldVal=e._val},X=(t,e)=>$(t,y(e,t));const F={add:j,_:Q,tags:M(),tagsNS:M,state:W,val:L,oldVal:q,derive:R,hydrate:X},Y=t=>{for(const e of Object.keys(t))e.startsWith("@")&&(t[`on${e.slice(1)}`]=t[e],delete t[e]);return t};function Z(t,e,...s){let o=Y({...e});const n=F.tags[t];return o?n(o,...s):n(...s)}const ee=G.bind(Z),{state:te,derive:se}=F;a.ReactiveWC=T,a.defineComponent=B,a.derive=se,a.html=ee,a.state=te,Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})});
